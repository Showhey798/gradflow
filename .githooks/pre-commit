#!/bin/bash

# GradFlow - Pre-commit hook
# main ブランチへの直接コミットを防ぐ

BRANCH=$(git symbolic-ref HEAD | sed -e 's,.*/\(.*\),\1,')

if [ "$BRANCH" = "main" ]; then
    echo ""
    echo "❌ エラー: main ブランチへの直接コミットは禁止されています"
    echo ""
    echo "代わりに、以下の手順でフィーチャーブランチを作成してください："
    echo ""
    echo "  1. フィーチャーブランチを作成:"
    echo "     git checkout -b feature/your-feature-name"
    echo ""
    echo "  2. 変更をコミット:"
    echo "     git commit -m \"your commit message\""
    echo ""
    echo "  3. ブランチを push:"
    echo "     git push origin feature/your-feature-name"
    echo ""
    echo "  4. Pull Request を作成:"
    echo "     gh pr create --title \"Your PR title\" --body \"Description\""
    echo ""
    echo "緊急の場合は、以下のコマンドでこのフックをスキップできます（非推奨）："
    echo "  git commit --no-verify"
    echo ""
    exit 1
fi

exit 0
